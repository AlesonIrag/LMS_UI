<div class="p-6">
  <div class="mb-6">
    <h1 class="text-2xl font-bold" [class]="getTextClasses()">Students Login/Logout</h1>
    <p class="mt-1" [class]="getSecondaryTextClasses()">
      Track student login and logout activities for this week
    </p>
    <div class="mt-2 p-3 rounded-lg bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800">
      <div class="flex items-start">
        <svg class="flex-shrink-0 w-5 h-5 text-blue-500 dark:text-blue-400 mt-0.5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <p class="text-sm" [class]="isDarkMode ? 'text-blue-200' : 'text-blue-800'">
          <span class="font-medium">Note:</span> This view includes both backend-tracked events and locally stored events from student devices.
        </p>
      </div>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
    <div class="rounded-lg border p-5 transition-colors duration-200" [class]="getCardClasses()">
      <div class="flex items-center">
        <div class="rounded-full p-3 bg-green-100 dark:bg-green-900">
          <svg class="w-6 h-6 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
          </svg>
        </div>
        <div class="ml-4">
          <p class="text-sm font-medium" [class]="getSecondaryTextClasses()">Logins</p>
          <p class="text-2xl font-semibold" [class]="getTextClasses()">{{ stats.logins }}</p>
        </div>
      </div>
    </div>

    <div class="rounded-lg border p-5 transition-colors duration-200" [class]="getCardClasses()">
      <div class="flex items-center">
        <div class="rounded-full p-3 bg-red-100 dark:bg-red-900">
          <svg class="w-6 h-6 text-red-600 dark:text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
          </svg>
        </div>
        <div class="ml-4">
          <p class="text-sm font-medium" [class]="getSecondaryTextClasses()">Logouts</p>
          <p class="text-2xl font-semibold" [class]="getTextClasses()">{{ stats.logouts }}</p>
        </div>
      </div>
    </div>

    <div class="rounded-lg border p-5 transition-colors duration-200" [class]="getCardClasses()">
      <div class="flex items-center">
        <div class="rounded-full p-3 bg-purple-100 dark:bg-purple-900">
          <svg class="w-6 h-6 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
          </svg>
        </div>
        <div class="ml-4">
          <p class="text-sm font-medium" [class]="getSecondaryTextClasses()">Students</p>
          <p class="text-2xl font-semibold" [class]="getTextClasses()">{{ stats.uniqueStudents }}</p>
        </div>
      </div>
    </div>

    <div class="rounded-lg border p-5 transition-colors duration-200" [class]="getCardClasses()">
      <div class="flex items-center">
        <div class="rounded-full p-3 bg-yellow-100 dark:bg-yellow-900">
          <svg class="w-6 h-6 text-yellow-600 dark:text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
          </svg>
        </div>
        <div class="ml-4">
          <p class="text-sm font-medium" [class]="getSecondaryTextClasses()">This Week</p>
          <p class="text-2xl font-semibold" [class]="getTextClasses()">{{ stats.uniqueStudents }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Controls -->
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-xl font-semibold" [class]="getTextClasses()">Login/Logout Activities</h2>
    <button 
      (click)="refreshData()" 
      class="flex items-center px-4 py-2 rounded-lg transition-colors duration-200"
      [class]="isDarkMode ? 'bg-gray-700 hover:bg-gray-600 text-white' : 'bg-gray-200 hover:bg-gray-300 text-gray-800'">
      <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
      </svg>
      Refresh
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="flex justify-center items-center py-12">
    <div class="flex flex-col items-center">
      <svg class="animate-spin h-10 w-10 text-blue-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      <p class="mt-4 text-lg" [class]="getTextClasses()">Loading student login/logout events...</p>
    </div>
  </div>

  <!-- Error State -->
  <!-- Removed error display as requested -->

  <!-- Events Table -->
  <div *ngIf="!loading" class="rounded-lg border transition-colors duration-200" [class]="getCardClasses()">
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y" [class]="isDarkMode ? 'divide-gray-700' : 'divide-gray-200'">
        <thead>
          <tr>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" 
                [class]="getSecondaryTextClasses()">Student</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" 
                [class]="getSecondaryTextClasses()">ID</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" 
                [class]="getSecondaryTextClasses()">Action</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" 
                [class]="getSecondaryTextClasses()">IP Address</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" 
                [class]="getSecondaryTextClasses()">Device</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider" 
                [class]="getSecondaryTextClasses()">Time</th>
          </tr>
        </thead>
        <tbody class="divide-y" [class]="isDarkMode ? 'divide-gray-700' : 'divide-gray-200'">
          <tr *ngFor="let event of filteredEvents" class="hover:bg-opacity-5 transition-colors duration-150" 
              [class]="isDarkMode ? 'hover:bg-gray-700' : 'hover:bg-gray-100'">
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center">
                <div class="flex-shrink-0 h-10 w-10">
                  <div class="h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center">
                    <span class="text-white font-medium">{{ event.studentName.charAt(0) }}</span>
                  </div>
                </div>
                <div class="ml-4">
                  <div class="text-sm font-medium" [class]="getTextClasses()">{{ event.studentName }}</div>
                </div>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="text-sm" [class]="getTextClasses()">{{ event.studentId }}</div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <span class="px-2.5 py-0.5 text-xs font-medium rounded-full border" 
                    [class]="getActionClass(event.action)">
                {{ event.action }}
              </span>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm" [class]="getSecondaryTextClasses()">
              {{ event.ipAddress }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm" [class]="getSecondaryTextClasses()">
              {{ event.deviceInfo }}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm" [class]="getTimestampClass()">
              {{ getTimeAgo(event.timestamp) }}
              <div class="text-xs" [class]="getSecondaryTextClasses()">
                {{ event.timestamp | date:'MMM d, h:mm a' }}
              </div>
            </td>
          </tr>
          <tr *ngIf="filteredEvents.length === 0">
            <td colspan="6" class="px-6 py-12 text-center">
              <svg class="mx-auto h-12 w-12" [class]="isDarkMode ? 'text-gray-600' : 'text-gray-400'" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
              </svg>
              <h3 class="mt-2 text-sm font-medium" [class]="getTextClasses()">No events found</h3>
              <p class="mt-1 text-sm" [class]="getSecondaryTextClasses()">
                No student login or logout events recorded for this week.
              </p>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>